<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sorteo Exclusivo</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
/* TODO TU DISE√ëO EXACTAMENTE IGUAL */
body{margin:0;font-family:Arial, sans-serif;background:#111;color:white;}
header{background:#ff3c00;padding:20px;text-align:center;font-size:22px;font-weight:bold;overflow:hidden;}
.titulo-movimiento{display:inline-block;white-space:nowrap;animation:moverLado 8s linear infinite;}
@keyframes moverLado{0%{ transform:translateX(-100%);}100%{ transform:translateX(100%);}}
.container{max-width:900px;margin:auto;padding:20px;}
.card{background:#1b1b1b;padding:20px;margin-bottom:20px;border-radius:10px;}
input,button{width:100%;padding:12px;margin-top:10px;border-radius:6px;border:none;font-size:15px;}
input{background:#2a2a2a;color:white;}
button{background:#ff3c00;color:white;font-weight:bold;cursor:pointer;}
button:hover{background:#ff1e00;}
.participant{background:#222;padding:10px;margin-top:5px;border-radius:5px;}
#winner{font-size:26px;color:#00ff88;text-align:center;margin-top:20px;font-weight:bold;}
.hidden{display:none;}
.admin{margin-top:40px;border-top:1px solid #333;padding-top:20px;}
</style>
</head>
<body>

<header>
<div class="titulo-movimiento">
üëë SORTEO EXCLUSIVO ‚Ä¢ CUENTA FREE FIRE
</div>
</header>

<div class="container">

<div class="card">
<h2>üìú M√©todo del Sorteo</h2>
<p>
El ganador ser√° el n√∫mero EXACTO correspondiente a los √∫ltimos dos n√∫meros
del primer premio de la Loter√≠a Nacional RD.
Si supera el total de participantes, se reducir√° autom√°ticamente.
</p>
</div>

<div class="card" id="registroCard">
<h2>üìù Registro</h2>
<input type="text" id="nombre" placeholder="Nombre completo">
<input type="text" id="whatsapp" placeholder="WhatsApp">
<input type="text" id="freefire" placeholder="ID de Free Fire">
<button onclick="registrar()">Participar</button>
<p id="numeroAsignado"></p>
</div>

<div class="card">
<h2>üë• Participantes (<span id="total">0</span>)</h2>
<div id="lista"></div>
</div>

<div id="winner"></div>

</div>

<script>

const SUPABASE_URL = "https://ltfesporfuujatkidwdv.supabase.co";
const SUPABASE_KEY = "sb_publishable_ezYdaI3BHqY98Uaf1KsE1g_R0OUIm8S";

const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

async function cargarParticipantes(){
    const { data } = await supabase
        .from("participantes")
        .select("*")
        .order("id", { ascending: true });

    document.getElementById("lista").innerHTML = "";

    data.forEach((p,index)=>{
        document.getElementById("lista").innerHTML +=
        `<div class="participant">#${index+1} - ${p.nombre}</div>`;
    });

    document.getElementById("total").innerText = data.length;
}

async function registrar(){

    let nombre = document.getElementById("nombre").value.trim();
    let whatsapp = document.getElementById("whatsapp").value.trim();
    let freefire = document.getElementById("freefire").value.trim();

    if(!nombre || !whatsapp || !freefire){
        alert("Completa todos los campos");
        return;
    }

    await supabase.from("participantes").insert([
        { nombre, whatsapp, freefire }
    ]);

    document.getElementById("nombre").value="";
    document.getElementById("whatsapp").value="";
    document.getElementById("freefire").value="";

    cargarParticipantes();
}

cargarParticipantes();

</script>

</body>
</html>
